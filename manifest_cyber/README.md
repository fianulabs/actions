# Fianu Manifest Cyber Capture SBOM Evidence Action

This GitHub Action captures evidence generated by the manifest cyber GitHub action using the Fianu CLI.

## Inputs

| Name                         | Description                                                                                                     | Required | Default                             |
|------------------------------|-----------------------------------------------------------------------------------------------------------------|----------|-------------------------------------|
| `fianu-service-account`      | The Fianu service account provided to your organization to perform keyless signing.                             | Yes      | N/A                                 |
| `manifest-cyber-sbom-output` | The path to the SBOM outputted by the manifest cyber action.                                                    | Yes      | N/A                                 |
| `bom-ref-path`               | Reference to the BOM ref in the JSON output. Defaults to the path for CycloneDX. For SPDX, the path is `.name`. | No       | `'.metadata.component.\"bom-ref\"'` |
| `audience`                   | Specifies the identity token audience to use when creating an identity token to authenticate with Fianu.        | No       | `sigstore`                          |
| `fianu-host`                 | Fianu host.                                                                                                     | Yes      | N/A                                 |
| `fianu-client-id`            | Fianu client ID.                                                                                                | Yes      | N/A                                 |
| `fianu-client-secret`        | Fianu client secret.                                                                                            | Yes      | N/A                                 |
| `manifest-cyber-host`        | Manifest Cyber host.                                                                                            | No       | `https://api.manifestcyber.com`     |

## Usage

```yaml
name: Capture Manifest Cyber Evidence Using the Fianu CLI
on: [ push ]
jobs:
  capture-evidence:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: Capture Evidence
        uses: fianulabs/fianu-manifest-cyber-sbom-action@main
        with:
          fianu-service-account: ${{ secrets.FIANU_SERVICE_ACCOUNT }}
          manifest-cyber-sbom-output: 'path/to/sbom/output'
          bom-ref-path: '.metadata.component."bom-ref"'
          audience: 'sigstore'
          fianu-host: ${{ secrets.FIANU_HOST }}
          fianu-client-id: ${{ secrets.FIANU_CLIENT_ID }}
          fianu-client-secret: ${{ secrets.FIANU_CLIENT_SECRET }}
          manifest-cyber-host: 'https://api.manifestcyber.com'
```

## Steps

1. **Authenticate to Google Cloud**:
   Authenticates using Google Cloud with the specified identity token audience and Fianu service account.

2. **Install Cosign**:
   Installs Cosign tool for signing.

3. **Extract SBOM Reference**:
   Extracts the SBOM reference using `jq`.

4. **Capture Evidence**:
   Uses Fianu CLI to initialize, sign the SBOM blob with Cosign, declare the SBOM, and capture evidence.

### References

- [Manifest Cyber API (v1) Documentation](https://api-docs.manifestcyber.com/)

